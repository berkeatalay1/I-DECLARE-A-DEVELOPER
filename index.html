<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kurtuluşa Geri Sayım</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <!-- Cinzel (Başlık), Montserrat (Sayılar - Modern/Clean), Poppins (Metin) -->
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600&family=Montserrat:wght@100;300;500&family=Poppins:wght@300;400&display=swap" rel="stylesheet">
    <style>
        :root {
            --gold: #FFD700;
            --soft-white: rgba(255, 255, 255, 0.95);
            --glass-bg: rgba(255, 255, 255, 0.03); /* Çok daha şeffaf */
            --glass-border: rgba(255, 255, 255, 0.1);
        }

        body {
            /* Fallback Background */
            background: url('https://images.unsplash.com/photo-1470071459604-3b5ec3a7fe05?q=80&w=2074&auto=format&fit=crop') no-repeat center center fixed;
            background-size: cover;
            color: var(--soft-white);
            font-family: 'Poppins', sans-serif;
            overflow: hidden;
            height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
            transition: background-image 1.5s ease-in-out;
        }

        /* Cinematic Vignette Overlay */
        body::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at center, rgba(0,0,0,0.1) 0%, rgba(0,0,0,0.6) 100%);
            z-index: 0;
            pointer-events: none;
        }

        /* Particle Overlay */
        .particles {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            z-index: 1;
            pointer-events: none;
        }

        .particle {
            position: absolute;
            bottom: -20px;
            background: radial-gradient(circle, rgba(255,255,255,0.6) 0%, rgba(255,255,255,0) 70%);
            border-radius: 50%;
            animation: floatUp linear infinite;
        }

        @keyframes floatUp {
            0% { transform: translateY(0) scale(0.5); opacity: 0; }
            50% { opacity: 0.4; }
            100% { transform: translateY(-120vh) scale(1.2); opacity: 0; }
        }

        /* Main Content Layout */
        .content-wrapper {
            position: relative;
            z-index: 10;
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
            max-width: 1200px;
            padding: 0 20px;
        }

        .title {
            font-family: 'Cinzel', serif;
            font-size: 2.5rem; /* Biraz küçülttük, zarif olsun */
            font-weight: 400;
            margin-bottom: 3rem;
            color: rgba(255,255,255,0.9);
            text-shadow: 0 10px 30px rgba(0,0,0,0.5);
            letter-spacing: 0.3em;
            text-transform: uppercase;
            text-align: center;
            opacity: 0;
            animation: fadeDown 1.5s ease-out forwards;
        }

        @keyframes fadeDown {
            from { opacity: 0; transform: translateY(-30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Ultra Modern Timer Grid */
        .timer-container {
            display: flex;
            justify-content: center;
            gap: 2rem;
            flex-wrap: wrap;
        }

        /* Floating Glass Cards - The "Best UI" Part */
        .time-card {
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 160px;
            height: 220px;
            
            /* Ultra-Minimal Glass */
            background: rgba(255, 255, 255, 0.02);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: 30px;
            border: 1px solid rgba(255, 255, 255, 0.08);
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
            
            transition: all 0.5s cubic-bezier(0.23, 1, 0.32, 1);
            opacity: 0;
            animation: fadeUp 1s ease-out forwards;
        }

        /* Stagger animations */
        .time-card:nth-child(1) { animation-delay: 0.2s; }
        .time-card:nth-child(2) { animation-delay: 0.4s; }
        .time-card:nth-child(3) { animation-delay: 0.6s; }
        .time-card:nth-child(4) { animation-delay: 0.8s; }

        .time-card:hover {
            transform: translateY(-15px) scale(1.05);
            background: rgba(255, 255, 255, 0.08);
            border-color: rgba(255, 255, 255, 0.3);
            box-shadow: 0 30px 60px rgba(0,0,0,0.4), 0 0 30px rgba(255,255,255,0.1);
        }

        @keyframes fadeUp {
            from { opacity: 0; transform: translateY(40px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .number {
            font-family: 'Montserrat', sans-serif; /* Clean, modern geometry */
            font-size: 5rem;
            font-weight: 100; /* Ultra Thin - Luxury Look */
            color: #ffffff;
            line-height: 1;
            margin-bottom: 0.5rem;
            letter-spacing: -2px; /* Tight tracking for numbers */
            text-shadow: 0 0 20px rgba(255,255,255,0.2);
        }

        .label {
            font-family: 'Poppins', sans-serif;
            font-size: 0.75rem;
            color: rgba(255,255,255,0.6);
            text-transform: uppercase;
            letter-spacing: 0.2em;
            font-weight: 400;
        }

        /* Message Area */
        .message-container {
            margin-top: 4rem;
            height: 30px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .message {
            font-family: 'Cinzel', serif;
            font-size: 1.1rem;
            color: rgba(255,255,255,0.8);
            letter-spacing: 0.4em;
            text-transform: uppercase;
            animation: fadeInOut 5s infinite;
        }

        /* Modern Bottom Dock (Controls) */
        .bottom-dock {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 50;
            display: flex;
            gap: 15px;
            padding: 10px 20px;
            background: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            border-radius: 50px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }

        .bottom-dock:hover {
            background: rgba(0, 0, 0, 0.5);
            border-color: rgba(255, 255, 255, 0.2);
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .dock-btn {
            background: transparent;
            border: none;
            color: rgba(255,255,255,0.7);
            cursor: pointer;
            padding: 8px;
            border-radius: 50%;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .dock-btn:hover {
            color: #fff;
            background: rgba(255,255,255,0.1);
            transform: scale(1.1);
        }

        .dock-separator {
            width: 1px;
            background: rgba(255,255,255,0.1);
            margin: 0 5px;
        }

        /* Settings Modal - Redesigned */
        #settings-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7); /* Darker focus */
            backdrop-filter: blur(10px);
            z-index: 100;
            justify-content: center;
            align-items: center;
            animation: fadeIn 0.3s ease;
        }

        .settings-content {
            background: rgba(20, 20, 20, 0.95);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 20px;
            padding: 3rem;
            text-align: center;
            box-shadow: 0 50px 100px -20px rgba(0, 0, 0, 0.8);
            color: #fff;
            width: 90%;
            max-width: 450px;
        }

        input[type="datetime-local"] {
            background: rgba(255,255,255,0.05);
            color: #fff;
            border: 1px solid rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 12px;
            font-family: 'Poppins', sans-serif;
            width: 100%;
            margin: 20px 0;
            outline: none;
        }
        
        input[type="datetime-local"]::-webkit-calendar-picker-indicator {
            filter: invert(1);
            opacity: 0.5;
            cursor: pointer;
        }

        /* Checkbox Custom */
        .checkbox-wrapper {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
            padding: 15px;
            background: rgba(255,255,255,0.03);
            border-radius: 12px;
            border: 1px solid transparent;
            transition: all 0.3s;
            cursor: pointer;
        }

        .checkbox-wrapper:hover {
            background: rgba(255,255,255,0.06);
            border-color: rgba(255,255,255,0.1);
        }

        input[type="checkbox"] {
            appearance: none;
            width: 20px;
            height: 20px;
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 6px;
            position: relative;
            cursor: pointer;
            transition: all 0.2s;
        }

        input[type="checkbox"]:checked {
            background-color: #11998e;
            border-color: #11998e;
        }

        input[type="checkbox"]:checked::after {
            content: '✓';
            position: absolute;
            color: white;
            font-size: 14px;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        button.save-btn {
            background: #fff;
            color: #000;
            border: none;
            padding: 14px 40px;
            border-radius: 50px;
            font-family: 'Poppins', sans-serif;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 10px;
        }

        button.save-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(255,255,255,0.3);
        }

        /* Mobile Adjustments */
        @media (max-width: 768px) {
            .title { font-size: 1.5rem; margin-bottom: 2rem; }
            .timer-container { gap: 10px; }
            .time-card { width: 45%; height: 160px; }
            .number { font-size: 3.5rem; }
            .bottom-dock { width: 90%; justify-content: space-around; }
        }
    </style>
</head>
<body>

    <!-- Particle Overlay -->
    <div class="particles" id="particles"></div>

    <!-- Main Visual Wrapper -->
    <div class="content-wrapper">
        <h1 class="title">YENİ BİR ŞAFAK</h1>
        
        <div class="timer-container" id="timer">
            <div class="time-card">
                <span class="number" id="days">00</span>
                <span class="label">Gün</span>
            </div>
            <div class="time-card">
                <span class="number" id="hours">00</span>
                <span class="label">Saat</span>
            </div>
            <div class="time-card">
                <span class="number" id="minutes">00</span>
                <span class="label">Dakika</span>
            </div>
            <div class="time-card">
                <span class="number" id="seconds">00</span>
                <span class="label">Saniye</span>
            </div>
        </div>

        <div class="message-container">
            <div class="message" id="status-message">
                UMUT YÜKSELİYOR
            </div>
        </div>
    </div>

    <!-- Modern Bottom Dock Controls -->
    <div class="bottom-dock">
        <button class="dock-btn" onclick="cycleBackground()" title="Manzarayı Değiştir">
            <!-- Refresh Icon -->
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21.5 2v6h-6M21.34 5.5A10 10 0 1 1 11.26 2.8"/></svg>
        </button>
        
        <div class="dock-separator"></div>
        
        <button class="dock-btn" onclick="openSettings()" title="Ayarlar">
            <!-- Settings Icon -->
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path></svg>
        </button>
    </div>

    <!-- Settings Modal -->
    <div id="settings-modal">
        <div class="settings-content">
            <h2 style="font-family: 'Cinzel', serif; font-size: 1.5rem; margin-bottom: 0.5rem; letter-spacing: 2px;">ZAMANI BELİRLE</h2>
            <p style="font-family: 'Poppins', sans-serif; font-size: 0.85rem; color: rgba(255,255,255,0.5); margin-bottom: 1.5rem;">Kader anı ne zaman?</p>
            
            <input type="datetime-local" id="target-date-input">

            <div class="checkbox-wrapper" onclick="document.getElementById('edip-check').click()">
                <input type="checkbox" id="edip-check" onchange="toggleMode('edip'); event.stopPropagation();">
                <label for="edip-check" class="checkbox-label" style="font-family: 'Poppins', sans-serif; font-size: 0.9rem;">Edip Ceylan Modu</label>
            </div>

            <div class="checkbox-wrapper" onclick="document.getElementById('accounting-check').click()">
                <input type="checkbox" id="accounting-check" onchange="toggleMode('accounting'); event.stopPropagation();">
                <label for="accounting-check" class="checkbox-label" style="font-family: 'Poppins', sans-serif; font-size: 0.9rem;">Muhasebe Zamanı</label>
            </div>

            <div style="display: flex; gap: 15px; justify-content: center; margin-top: 20px;">
                <button class="save-btn" onclick="saveDate()">Uygula</button>
                <button class="save-btn" onclick="closeSettings()" style="background: transparent; border: 1px solid rgba(255,255,255,0.3); color: #fff;">İptal</button>
            </div>
        </div>
    </div>

    <script>
        // --- 10 Günlük Arka Plan Listesi ---
        const backgroundImages = [
            'https://images.unsplash.com/photo-1470071459604-3b5ec3a7fe05?q=80&w=2074&auto=format&fit=crop', 
            'https://images.unsplash.com/photo-1441974231531-c6227db76b6e?q=80&w=2071&auto=format&fit=crop', 
            'https://images.unsplash.com/photo-1472214103451-9374bd1c798e?q=80&w=2070&auto=format&fit=crop', 
            'https://images.unsplash.com/photo-1501854140884-074bf6b243e7?q=80&w=2069&auto=format&fit=crop', 
            'https://images.unsplash.com/photo-1507525428034-b723cf961d3e?q=80&w=2073&auto=format&fit=crop', 
            'https://images.unsplash.com/photo-1519681393784-d120267933ba?q=80&w=2070&auto=format&fit=crop', 
            'https://images.unsplash.com/photo-1426604966848-d7adac402bff?q=80&w=2070&auto=format&fit=crop', 
            'https://images.unsplash.com/photo-1497436072909-60f360e1d4b0?q=80&w=2560&auto=format&fit=crop', 
            'https://images.unsplash.com/photo-1469474968028-56623f02e42e?q=80&w=2074&auto=format&fit=crop', 
            'https://images.unsplash.com/photo-1500964757637-c85e8a162699?q=80&w=2078&auto=format&fit=crop', 
            'https://pbs.twimg.com/media/G-p1kmLbMAADuYm?format=jpg&name=large'
        ];

        let currentImageIndex = 0;

        function setDailyBackground() {
            const today = new Date();
            const dayIndex = Math.floor(today.getTime() / (1000 * 60 * 60 * 24));
            currentImageIndex = dayIndex % backgroundImages.length;
            document.body.style.backgroundImage = `url('${backgroundImages[currentImageIndex]}')`;
        }

        function cycleBackground() {
            currentImageIndex = (currentImageIndex + 1) % backgroundImages.length;
            document.body.style.backgroundImage = `url('${backgroundImages[currentImageIndex]}')`;
        }

        // --- Particle Generation ---
        function createParticles() {
            const container = document.getElementById('particles');
            const particleCount = 40;
            
            for(let i=0; i<particleCount; i++) {
                const p = document.createElement('div');
                p.classList.add('particle');
                const size = Math.random() * 6 + 2; // Smaller, more elegant particles
                p.style.left = Math.random() * 100 + '%';
                p.style.width = size + 'px';
                p.style.height = size + 'px';
                const duration = Math.random() * 20 + 15; // Slower movement
                const delay = Math.random() * -20;
                p.style.animationDuration = duration + 's';
                p.style.animationDelay = delay + 's';
                container.appendChild(p);
            }
        }
        createParticles();

        // --- Logic ---
        const DEFAULT_DATE = "2026-01-23T16:45:00"; 
        const EDIP_DATE = "2026-01-17T16:45:00";
        const ACCOUNTING_DATE = "2026-01-26T16:45:00";

        const STORAGE_KEY_DATE = 'salvation_deadline';
        const STORAGE_KEY_MODE = 'salvation_mode';
        const STORAGE_KEY_BACKUP = 'salvation_backup_date';

        let targetDate;
        let currentMode = null; 
        let tempDateBackup = ""; 

        const defaultMessages = [
            "UMUT YÜKSELİYOR", "DAHA PARLAK BİR GELECEK", "O AN ÇOK YAKIN",
            "IŞIK KAZANACAK", "NEŞE BİZİ BEKLİYOR", "HAYALLER GERÇEK OLUYOR",
            "ZAFER BİZİM OLACAK", "BEKLEDİĞİMİZE DEĞECEK", "GÜNEŞ DOĞUYOR",
            "MUTLULUK KAPIDA", "YENİ BİR BAŞLANGIÇ", "BİRLİKTE DAHA GÜÇLÜYÜZ"
        ];

        const accountingMessages = [
            "FİŞLERİ HAZIRLA", "BEYANNAME ZAMANI", "VERGİLER YAKLAŞIYOR",
            "HESAP VAKTİ", "KDV ÖDENDİ Mİ?", "BİLANÇO DENGELENİYOR",
            "MATRAH ARTIRIMI", "STOPAJ KAPIDA", "SON GÜN YAKLAŞIYOR"
        ];

        let messages = defaultMessages;

        function loadDate() {
            setDailyBackground();
            const storedMode = localStorage.getItem(STORAGE_KEY_MODE);
            currentMode = storedMode;

            if (storedMode === 'edip') {
                targetDate = new Date(EDIP_DATE).getTime();
                updateTheme('edip');
            } else if (storedMode === 'accounting') {
                targetDate = new Date(ACCOUNTING_DATE).getTime();
                updateTheme('accounting');
            } else {
                const storedDate = localStorage.getItem(STORAGE_KEY_DATE);
                if (storedDate) {
                    targetDate = new Date(storedDate).getTime();
                } else {
                    targetDate = new Date(DEFAULT_DATE).getTime();
                }
                updateTheme(null);
            }
        }

        function updateTheme(mode) {
            const titleEl = document.querySelector('.title');
            
            if (mode === 'accounting') {
                titleEl.innerText = "MUHASEBE ZAMANI";
                titleEl.style.color = "#FFD700";
                messages = accountingMessages;
            } else {
                titleEl.innerText = "YENİ BİR ŞAFAK";
                titleEl.style.color = "rgba(255,255,255,0.9)";
                messages = defaultMessages;
            }
            document.getElementById('status-message').innerText = messages[0];
        }

        let msgIndex = 0;
        setInterval(() => {
            const msgEl = document.getElementById('status-message');
            msgEl.style.transition = "opacity 1s ease";
            msgEl.style.opacity = 0; 
            setTimeout(() => {
                msgIndex = (msgIndex + 1) % messages.length;
                msgEl.innerText = messages[msgIndex];
                msgEl.style.opacity = 1; 
            }, 1000);
        }, 5000);

        function updateCountdown() {
            const now = new Date().getTime();
            const distance = targetDate - now;

            if (distance < 0) {
                let endTitle = "BAŞLADI";
                let endSub = "Yeni çağa hoş geldiniz";
                if (currentMode === 'accounting') {
                    endTitle = "SÜRE BİTTİ";
                    endSub = "Ceza yemeden gönder!";
                }

                document.getElementById("timer").innerHTML = `
                    <div style="width: 100%; text-align: center;">
                        <div style="font-family: 'Cinzel', serif; font-size: 5rem; color: #fff; text-shadow: 0 0 40px rgba(255,255,255,0.6); margin-bottom: 1rem;">${endTitle}</div>
                        <div style="font-family: 'Poppins', sans-serif; font-size: 1.5rem; opacity: 0.8; letter-spacing: 5px;">${endSub}</div>
                    </div>`;
                document.getElementById("status-message").style.display = "none";
                return;
            }
            
            const timerEl = document.getElementById("timer");
            if (!timerEl.classList.contains('timer-container')) return;

            const days = Math.floor(distance / (1000 * 60 * 60 * 24));
            const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((distance % (1000 * 60)) / 1000);

            if(document.getElementById("days")) {
                document.getElementById("days").innerText = days < 10 ? "0" + days : days;
                document.getElementById("hours").innerText = hours < 10 ? "0" + hours : hours;
                document.getElementById("minutes").innerText = minutes < 10 ? "0" + minutes : minutes;
                document.getElementById("seconds").innerText = seconds < 10 ? "0" + seconds : seconds;
            }
        }

        // --- Settings Modal Logic ---
        function openSettings() {
            document.getElementById('settings-modal').style.display = 'flex';
            
            const edipCheck = document.getElementById('edip-check');
            const accCheck = document.getElementById('accounting-check');
            const dateInput = document.getElementById('target-date-input');
            
            const storedMode = localStorage.getItem(STORAGE_KEY_MODE);

            edipCheck.checked = (storedMode === 'edip');
            accCheck.checked = (storedMode === 'accounting');

            let dateToSet;
            if (storedMode === 'edip') {
                dateToSet = EDIP_DATE;
                dateInput.disabled = true;
                dateInput.style.opacity = "0.5";
            } else if (storedMode === 'accounting') {
                dateToSet = ACCOUNTING_DATE;
                dateInput.disabled = true;
                dateInput.style.opacity = "0.5";
            } else {
                const dateObj = new Date(targetDate);
                dateToSet = new Date(dateObj.getTime() - (dateObj.getTimezoneOffset() * 60000)).toISOString().slice(0, 16);
                dateInput.disabled = false;
                dateInput.style.opacity = "1";
            }

            if (!dateToSet.includes('T')) {
                 const d = new Date(dateToSet);
                 dateToSet = new Date(d.getTime() - (d.getTimezoneOffset() * 60000)).toISOString().slice(0, 16);
            } else if (dateToSet.length > 16) {
                 dateToSet = dateToSet.slice(0, 16);
            }
            dateInput.value = dateToSet;

            tempDateBackup = localStorage.getItem(STORAGE_KEY_BACKUP);
            if (!tempDateBackup) {
                 const defDate = new Date(DEFAULT_DATE);
                 tempDateBackup = new Date(defDate.getTime() - (defDate.getTimezoneOffset() * 60000)).toISOString().slice(0, 16);
            }
        }

        function closeSettings() {
            document.getElementById('settings-modal').style.display = 'none';
        }

        function toggleMode(modeName) {
            const edipCheck = document.getElementById('edip-check');
            const accCheck = document.getElementById('accounting-check');
            const dateInput = document.getElementById('target-date-input');
            
            if (modeName === 'edip' && edipCheck.checked) accCheck.checked = false;
            if (modeName === 'accounting' && accCheck.checked) edipCheck.checked = false;

            if (edipCheck.checked) {
                if (!accCheck.checked && !dateInput.disabled) tempDateBackup = dateInput.value;
                dateInput.value = EDIP_DATE;
                dateInput.disabled = true;
                dateInput.style.opacity = "0.5";
            } else if (accCheck.checked) {
                if (!edipCheck.checked && !dateInput.disabled) tempDateBackup = dateInput.value;
                dateInput.value = ACCOUNTING_DATE;
                dateInput.disabled = true;
                dateInput.style.opacity = "0.5";
            } else {
                if(tempDateBackup) dateInput.value = tempDateBackup;
                dateInput.disabled = false;
                dateInput.style.opacity = "1";
            }
        }

        function saveDate() {
            const inputVal = document.getElementById('target-date-input').value;
            const edipCheck = document.getElementById('edip-check');
            const accCheck = document.getElementById('accounting-check');

            if (inputVal) {
                targetDate = new Date(inputVal).getTime();
                
                if (edipCheck.checked) {
                    localStorage.setItem(STORAGE_KEY_MODE, 'edip');
                    updateTheme('edip');
                } else if (accCheck.checked) {
                    localStorage.setItem(STORAGE_KEY_MODE, 'accounting');
                    updateTheme('accounting');
                } else {
                    localStorage.setItem(STORAGE_KEY_MODE, 'none');
                    localStorage.setItem(STORAGE_KEY_DATE, inputVal);
                    updateTheme(null);
                }
                
                if (tempDateBackup) {
                    localStorage.setItem(STORAGE_KEY_BACKUP, tempDateBackup);
                }

                updateCountdown();
                closeSettings();
            }
        }

        // --- Init ---
        loadDate();
        setInterval(updateCountdown, 1000);
        updateCountdown();

    </script>
</body>
</html>
